<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>打印预览</title>
    <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">
    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="This is my page">
    <link rel="stylesheet" type="text/css" href="../css/print.css">
    <!-- IE内置打印组件 -->
	<OBJECT id="WebBrowserOpener" name="WebBrowserOpener" classid=CLSID:8856F961-340A-11D0-A96B-00C04FD705A2 height="0" width="0" VIEWASTEXT></OBJECT>
	
	<style> 
	
	.tdp 
	{ 
		border-bottom: 1 solid #000000; 
		border-left: 1 solid #000000; 
		border-right: 0 solid #ffffff; 
		border-top: 0 solid #ffffff; 
	} 
	.tabp 
	{ 
		border-color: #000000 #000000 #000000 #000000; 
		border-style: solid; 
		border-top-width: 1px; 
		border-right-width: 1px; 
		border-bottom-width: 1px; 
		border-left-width: 1px; 
	}
	
	 .table_border_jx
		{
			border-collapse : collapse;
			border:solid #000000;
			border-width:1px 0 0 1px; /* 上、右、下、左、边框粗细 */
		}
		.table_border_jx th,.table_border_jx td
		{
			border : solid #000000;
			border-width : 0 1px 1px 0;
			padding : 0px;
			text-align : center;
		}
	
	</style> 	
	<script language='javascript'>
	
	// 是否要关闭窗口参数
	var canClose = false;


	/**
	* @author qin
	* @date 2007.6.28
	* @description 取父窗口的BODY填充当前窗口
	* @editor qin 2007.12.04 修改打印区域
	*/
	function getHTML()
	{
	    var win = window.opener;
	    if (!win) return;
	    var obj = win.document.all.tblList;
	    if (obj)
	    {
	        document.body.innerHTML = obj.outerHTML;
	    }
	    else
	    {
	       obj = win.document.body;
	       document.body.innerHTML = obj.innerHTML;
	    }
	    //document.body.innerHTML +='<input name="printButton" type="button" onclick="print()" value="打印" />&nbsp;&nbsp;';
	   // document.body.innerHTML +='<input name="closeButton" type="button" onClick="javascript:window.close()" value="关 闭"/>';
	}


	/**
	* @author qin
	* @date 2007.6.28
	* @description 取父窗口的BODY填充当前窗口
	*/
	function setStyle()
	{
	    var ary = document.getElementsByTagName("TABLE");
	    for (var i = 0; i < ary.length; i++)
	    {
	        // 隐藏提交按钮
	        var tn = ary[i].name;
	        if (tn)
	        { 
	            tn = tn.toLowerCase();
	            if (tn == "table_submit_buttons")
	            {
	                ary[i].style.display = "none";
	                continue;
	            }
	        }
	        
	        // 隐藏活动参与者
	        var tid = ary[i].id;
	        if (tid)
	        {
	            tid = tid.toLowerCase();
	            if (tid == "participant_table")
	            {
	                ary[i].style.display = "none";
	                continue;
	            }
	        }
	        
	        
	        /*
	        // 置表单打印样式：浏览器没有设置“打印背景”选择时启用
	        var cn = ary[i].className;
	        if (!cn) continue;
	        if (cn.toLowerCase() != "table_normal") continue;
	        
	        ary[i].cellspacing = 0;
	        
	        ary[i].className = 'tabp';
	        for (var j = 0; j < ary[i].rows.length; j++)
	        {
	            for (var k = 0; k < ary[i].rows[j].cells.length; k++)
	            {
		            ary[i].rows[j].cells[k].className = 'tdp';
	            }
	        }
	        */
	    }
	}

	
    
    
	/**
	* @author qin
	* @date 2007.6.28
	* @description 取父窗口的BODY填充当前窗口
	*/
	function doPrintPreview()
	{
	    try { document.all.WebBrowserOpener.ExecWB(7,1); } catch(e) {}
	}
    
    
	
	/**
	* @author qin
	* @date 2007.6.28
	* @description 打印预览
	*/
	function document.onreadystatechange(){
	    if (document.readyState == 'complete')
	    {
	        // set close window flag
	        canClose = true;
	        // set print style
		    setStyle();	    
		    // preview
	        doPrintPreview();
	    }
	}
	


	/**
	* @author qin
	* @date 2007.6.28
	* @description 关闭窗口
	*/
	function doClose()
	{
	    if (canClose)
	    {
	       try { document.all.WebBrowserOpener.ExecWB(45,1); } catch(e) {}
	    }
	}
	
	
	</script>
	</head>
	
    <body onmouseover="doClose();return false;" onmousemove="doClose();return false;" onclick="doClose();return false;"></body>
	
</html>


<script language='javascript'>
// 初始化
getHTML();
</script>

